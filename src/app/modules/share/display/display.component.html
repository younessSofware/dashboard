<div  class="mx-3 pb-7">
  <div class="flex my-3 justify-between" *ngIf="data">
    <span class="text-3xl uppercase">
      <i [class]="icon"></i>
      {{ singleName }}
    </span>
    <div class="flex">
      <section
        *ngFor="let button of buttons"
      >
          <button
            *ngIf="allowToShowBtn(button)"
            [class]="'p-2 px-3 text-sm bg-' + button.color + '-500 text-white rounded-md hover:bg-' + button.color + '-600 mx-1'"
            (click)="handleBtn(button)"
          >
            <i [class]="button.icon + ' mr-1'"></i>
            {{ button.name }}
          </button>
      </section>
    </div>
  </div>
  <hr>
  <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mx-4 my-4" *ngIf="error">
    <p class="font-bold">{{error}}</p>
  </div>
  <div *ngIf="data && headers" class="flex flex-wrap mb-6 w-full pb-4">
    <div *ngFor="let header of headers" class="px-3 my-2" [class]="[header.width ? 'w-' + header.width : 'w-full']">
      <span
        class="block uppercase tracking-wide text-gray-700 text-md font-bold mb-2"
      >
        {{ header.title }}
      </span>
      <section
        class="text-md py-3 px-1"
        [ngClass]="[header.type != 'image' && header.type != 'avatar' ? 'border-t-2 border-b-2 border-gray-300 bg-gray-50 flex justify-between items-center' : '']"
        [ngSwitch]="header.type"
      >
        <section *ngSwitchCase="header.type == 'image' || header.type == 'avatar' ? header.type : ''">
          <div class="flex items-center justify-center">
            <div
              class="w-32 h-32 flex items-center rounded-full ring-2 ring-gray-300 overflow-hidden"
            >
              <img
                class="w-full min-h-full rounded-full"
                [src]="data[header.name]"
                alt=""
              >
            </div>
          </div>
        </section>
        <section *ngSwitchCase="'boolean'">
          <span
            *ngSwitchCase="'boolean'"
            class="inline-flex leading-5 font-semibold"
            [ngClass]="[(header.reverseBooleanColors ? !data[header.name] : data[header.name])  ? 'text-green-500' : 'text-red-500']"
          >
            <span *ngIf="header.values">{{ header.values[data[header.name] ? 1 : 0] }}</span>
          </span>
        </section>
        <section *ngSwitchCase="'tags'">
          <span
            *ngFor="let tag of data[header.name]; let ind = index"
            class="mr-1 inline-block border-2 border-indigo-400 p-2 rounded-lg"
          >
            {{ tag }}
          </span>
        </section>
        <section *ngSwitchCase="'date'">
          <span>
            {{ data[header.name] | date: 'longDate' }}
          </span>
        </section>
        <section *ngSwitchDefault>
          <span>
            {{ data[header.name] ? data[header.name] :  header.default }}
          </span>
        </section>
        <button (click)="navigateToLink(header)" class="border-2 py-2 px-3 text-sm rounded-lg border-indigo-200 hover:bg-indigo-200 " *ngIf="header.link">
          <i class="fas fa-eye"></i>
        </button>
      </section>
    </div>
  </div>

  <div class="my-3 mx-2" *ngIf="list && data">
    <span class="text-3xl capitalize flex justify-between">
      <span>
        <i [class]="list.icon + ' mr-1'"></i>
        {{ list.title }}
      </span>
      <button
        (click)="handleBtn(button)"
        *ngFor="let button of list.buttons"
        [class]="'p-2 mx-2 text-sm rounded-xl border-2 border-' + button.color + '-200 hover:bg-' + button.color + '-200'"
      >
        <i [class]="button.icon + ' mx-2'" ></i>
        {{ button.name }}
      </button>
    </span>
    <table class="min-w-full divide-y divide-gray-200 mt-4">
      <thead class="bg-black">
        <tr>
          <th
            *ngFor="let header of list.headers"
            scope="col"
            class="py-3 px-2 text-xs font-medium text-left text-white uppercase tracking-wider"
          >
            {{ header.title }}
          </th>
          <th></th>
        </tr>
      </thead>
      <tbody *ngIf="data[list.name] && data[list.name].length" class="bg-white divide-y divide-gray-200">
        <tr [class.bg-gray-100]="ind % 2" *ngFor="let d of data[list.name]; let ind = index">
          <td class="py-2 whitespace-nowrap px-2 border-2 border-gray-200" *ngFor="let header of list.headers">
            <section [ngSwitch]="header.type">
              <span *ngSwitchCase="'date'"> {{ d[header.name] | date: "medium" }} </span>
              <div class="text-gray-900" *ngSwitchDefault>{{ d[header.name] | resumeText: header.maxLength ? header.maxLength : null }}</div>
            </section>
          </td>
          <td class="text-right py-2 whitespace-nowrap px-2 border-2 border-gray-200">
            <button
              (click)="listNavigateToLink(button, d)"
              [class]="'mx-2 py-2 px-3 rounded-lg border-2 border-' + button.color + '-100 hover:bg-' + button.color + '-200'"
              *ngFor="let button of list.rowsButtons"
            >
              <i [class]="button.icon"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <app-alert title="Empty Result" message="No data found (0)" type="info" *ngIf="data[list.name] && !data[list.name].length"></app-alert>
  </div>
</div>
